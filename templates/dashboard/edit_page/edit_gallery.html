{% extends 'dashboard/edit_page/edit.html' %}
{% load static %}

<h1 class="d-inline-block ml-auto">{% block dashboard_title %}Edit Gallery{% endblock dashboard_title %}</h1>

{% block content %}
<form id="editGalleryForm" method="post" enctype="multipart/form-data" class="mt-4">
    {% csrf_token %}
    <div class="form-group">
        {{ form.name.label_tag }}
        {{ form.name }}
    </div>
    <div class="form-group">
        {{ form.description.label_tag }}
        {{ form.description }}
    </div>

    <h2>Images</h2>
    <div class="form-group">
        <div class="row">
            {% for image in gallery.images.all %}
            <div class="col-6 col-md-3">
                <img src="{{ image.image.url }}" alt="{{ image.caption }}" class="img-fluid" style="max-width: 120px; height: auto;">
            </div>
            {% endfor %}
        </div>
    </div>

    <div class="form-group">
        <label for="id_image">Add Image:</label>
        <input type="file" name="image" id="id_image" class="form-control-file">
    </div>

    <button type="submit" class="btn btn-primary" id="saveProductChangesButton">
        <i class="fa-solid fa-floppy-disk"></i> Save Changes
    </button>
</form>



<script>
    // Function to show SweetAlert confirmation for form submission
    function confirmFormSubmission(event) {
        event.preventDefault(); // Prevent the default form submission

        Swal.fire({
            title: 'Save Changes?',
            text: 'Are you sure you want to save the changes?',
            icon: 'question',
            showCancelButton: true,
            confirmButtonColor: '#3085d6',
            cancelButtonColor: '#d33',
            confirmButtonText: 'Yes, save changes!'
        }).then((result) => {
            if (result.isConfirmed) {
                // Submit the form if confirmed
                document.getElementById('editGalleryForm').submit();
            }
        });
    }

    // Attach the confirmation function to the Enter key press event
    document.addEventListener('keydown', function (event) {
        if (event.key === 'Enter') {
            confirmFormSubmission(event);
        }
    });

    // Attach the confirmation function to the form submission event
    document.getElementById('editGalleryForm').addEventListener('submit', confirmFormSubmission);
</script>

{% endblock content %}
